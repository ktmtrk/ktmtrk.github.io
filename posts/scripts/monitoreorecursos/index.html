<!DOCTYPE html>

<html>
<head>

<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://ktmtrk.github.io/posts/scripts/monitoreorecursos/" />
<link rel="stylesheet" href="https://ktmtrk.github.io/brand/nova.css" />


<meta name="description" content="Script realizado para obtener algunos valores del top (linux) filtrado de columnas, el script se ejecuta cada 30&amp;rsquo; para imprimirlos por pantalla y a la vez grabar cada registro en un archivo csv En este caso se adapto para sacar la carga de 48 nucleos de un servidor.
load_avg.sh
#!/bin/bash sep=&amp;#34;|&amp;#34; #title head=&amp;#34;timestamp&amp;#34;$sep&amp;#34;load_avg&amp;#34;$sep&amp;#34;%-/&amp;#34;$sep&amp;#34;free_mem&amp;#34;$sep&amp;#34;proc01&amp;#34;$sep&amp;#34;proc_02&amp;#34;$sep&amp;#34;proc_03&amp;#34;$sep&amp;#34;proc_04&amp;#34;$sep&amp;#34;proc_05&amp;#34;$sep&amp;#34;proc_06&amp;#34;$sep&amp;#34;proc07&amp;#34;$sep&amp;#34;proc_08&amp;#34;$sep&amp;#34;proc_09&amp;#34;$sep&amp;#34;proc_10&amp;#34;$sep&amp;#34;proc_11&amp;#34;$sep&amp;#34;proc_12&amp;#34;$sep&amp;#34;proc_13&amp;#34;$sep&amp;#34;proc_14&amp;#34;$sep&amp;#34;proc_15&amp;#34;$sep&amp;#34;proc_16&amp;#34;$sep&amp;#34;proc_17&amp;#34;$sep&amp;#34;proc_18&amp;#34;$sep&amp;#34;proc_19&amp;#34;$sep&amp;#34;proc_20&amp;#34;$sep&amp;#34;proc_21&amp;#34;$sep&amp;#34;proc_22&amp;#34;$sep&amp;#34;proc_23&amp;#34;$sep&amp;#34;proc_24&amp;#34;$sep&amp;#34;proc_25&amp;#34;$sep&amp;#34;proc_26&amp;#34;$sep&amp;#34;proc_27&amp;#34;$sep&amp;#34;proc_28&amp;#34;$sep&amp;#34;proc_29&amp;#34;$sep&amp;#34;proc_30&amp;#34;$sep&amp;#34;proc_31&amp;#34;$sep&amp;#34;proc_32&amp;#34;$sep&amp;#34;proc_33&amp;#34;$sep&amp;#34;proc_34&amp;#34;$sep&amp;#34;proc_35&amp;#34;$sep&amp;#34;proc_36&amp;#34;$sep&amp;#34;proc_37&amp;#34;$sep&amp;#34;proc_38&amp;#34;$sep&amp;#34;proc_39&amp;#34;$sep&amp;#34;proc_40&amp;#34;$sep&amp;#34;proc_41&amp;#34;$sep&amp;#34;proc_42&amp;#34;$sep&amp;#34;proc_42&amp;#34;$sep&amp;#34;proc_43&amp;#34;$sep&amp;#34;proc_44&amp;#34;$sep&amp;#34;proc_45&amp;#34;$sep&amp;#34;proc_46&amp;#34;$sep&amp;#34;proc_47&amp;#34;$sep&amp;#34;proc_48&amp;#34; echo $head echo $head &amp;gt; loadavg_output.csv for (( ; ; )); do	#LOOP INFINITO #variables timestamp=`date &#43;%Y-%m-%d_%H-%M-%S` load=`cat /proc/loadavg | awk &amp;#39;{print $1}&amp;#39;` quote=`df -h / | awk &amp;#39;{print $5}&amp;#39;| tail -n 1` #uso del directorio raiz free_mem=`free -g | awk &amp;#39;{print $3}&amp;#39; | sed -n 2p` #Procesadores (48) proc_01=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $2}&amp;#39;` proc_02=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $4}&amp;#39;` proc_03=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $6}&amp;#39;` proc_04=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $8}&amp;#39;` proc_05=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $10}&amp;#39;` proc_06=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $12}&amp;#39;` proc_07=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $14}&amp;#39;` proc_09=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $16}&amp;#39;` proc_10=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $18}&amp;#39;` proc_11=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $20}&amp;#39;` proc_12=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $22}&amp;#39;` proc_13=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $24}&amp;#39;` proc_14=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $26}&amp;#39;` proc_15=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $28}&amp;#39;` proc_16=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $30}&amp;#39;` proc_17=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $32}&amp;#39;` proc_18=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $34}&amp;#39;` proc_19=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $36}&amp;#39;` proc_20=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $38}&amp;#39;` proc_21=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $40}&amp;#39;` proc_22=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $42}&amp;#39;` proc_23=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $44}&amp;#39;` proc_24=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $46}&amp;#39;` proc_25=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $48}&amp;#39;` proc_26=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $50}&amp;#39;` proc_27=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $52}&amp;#39;` proc_28=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $54}&amp;#39;` proc_29=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $56}&amp;#39;` proc_30=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $58}&amp;#39;` proc_31=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $60}&amp;#39;` proc_32=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $62}&amp;#39;` proc_33=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $64}&amp;#39;` proc_34=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $66}&amp;#39;` proc_35=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $68}&amp;#39;` proc_36=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $70}&amp;#39;` proc_37=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $72}&amp;#39;` proc_38=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $74}&amp;#39;` proc_39=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $76}&amp;#39;` proc_40=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $78}&amp;#39;` proc_41=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $80}&amp;#39;` proc_42=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $82}&amp;#39;` proc_43=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $84}&amp;#39;` proc_44=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $86}&amp;#39;` proc_45=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $88}&amp;#39;` proc_46=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $90}&amp;#39;` proc_47=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $92}&amp;#39;` proc_48=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $94}&amp;#39;` sleep 30 &amp;amp;	#guardo toda la info dentro de una variable var=$(echo $timestamp$sep$load$sep$quote$sep$free_mem$sep$proc_01$sep$proc_02$sep$proc_03$sep$proc_04$sep$proc_05$sep$proc_06$sep$proc_07$sep$proc_08sep$proc_09$sep$proc_10$sep$proc_11$sep$proc_12$sep$proc_13$sep$proc_14$sep$proc_15$sep$proc_16$sep$proc_17$sep$proc_18$sep$proc_19$sep$proc_20$sep$proc_21$sep$proc_22$sep$proc_23$sep$proc_24$sep$proc_25$sep$proc_26$sep$proc_27$sep$proc_28$sep$proc_29$sep$proc_30$sep$proc_31$sep$proc_32$sep$proc_33$sep$proc_34$sep$proc_35$sep$proc_36$sep$proc_37$sep$proc_38$sep$proc_39$sep$proc_40$sep$proc_41$sep$proc_42$sep$proc_43$sep$proc_44$sep$proc_45$sep$proc_46$sep$proc_47$sep$proc_48) echo $var echo $var &amp;gt;&amp;gt; loadavg_output."/>
<meta name="keywords" content="Book, Purchase, Sign up, Author, Download, PDF, Capitalism, Hacking, Tech Industry, Silicon Valley, San Francisco, Bay Area, Exploit, Career, Guide, Humans, Computers, Money, books, booktok, bookish, bookworm, bookrecs, fyp, book, foryou, bookstan"/>


<meta name="twitter:image" content="/images/console.png"/>
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="lwn">
<meta name="twitter:site" content="">

<meta property="og:image" content="/images/console.png" />
<meta property="og:type" content="website" />
<meta property="og:url" content="Hacking" />
<meta property="og:site_name" content="" />


<meta name="twitter:title" content="Script Monitoreo de Recursos"/>
<meta name="twitter:description" content="Script realizado para obtener algunos valores del top (linux) filtrado de columnas, el script se ejecuta cada 30&amp;rsquo; para imprimirlos por pantalla y a la vez grabar cada registro en un archivo csv En este caso se adapto para sacar la carga de 48 nucleos de un servidor.
load_avg.sh
#!/bin/bash sep=&amp;#34;|&amp;#34; #title head=&amp;#34;timestamp&amp;#34;$sep&amp;#34;load_avg&amp;#34;$sep&amp;#34;%-/&amp;#34;$sep&amp;#34;free_mem&amp;#34;$sep&amp;#34;proc01&amp;#34;$sep&amp;#34;proc_02&amp;#34;$sep&amp;#34;proc_03&amp;#34;$sep&amp;#34;proc_04&amp;#34;$sep&amp;#34;proc_05&amp;#34;$sep&amp;#34;proc_06&amp;#34;$sep&amp;#34;proc07&amp;#34;$sep&amp;#34;proc_08&amp;#34;$sep&amp;#34;proc_09&amp;#34;$sep&amp;#34;proc_10&amp;#34;$sep&amp;#34;proc_11&amp;#34;$sep&amp;#34;proc_12&amp;#34;$sep&amp;#34;proc_13&amp;#34;$sep&amp;#34;proc_14&amp;#34;$sep&amp;#34;proc_15&amp;#34;$sep&amp;#34;proc_16&amp;#34;$sep&amp;#34;proc_17&amp;#34;$sep&amp;#34;proc_18&amp;#34;$sep&amp;#34;proc_19&amp;#34;$sep&amp;#34;proc_20&amp;#34;$sep&amp;#34;proc_21&amp;#34;$sep&amp;#34;proc_22&amp;#34;$sep&amp;#34;proc_23&amp;#34;$sep&amp;#34;proc_24&amp;#34;$sep&amp;#34;proc_25&amp;#34;$sep&amp;#34;proc_26&amp;#34;$sep&amp;#34;proc_27&amp;#34;$sep&amp;#34;proc_28&amp;#34;$sep&amp;#34;proc_29&amp;#34;$sep&amp;#34;proc_30&amp;#34;$sep&amp;#34;proc_31&amp;#34;$sep&amp;#34;proc_32&amp;#34;$sep&amp;#34;proc_33&amp;#34;$sep&amp;#34;proc_34&amp;#34;$sep&amp;#34;proc_35&amp;#34;$sep&amp;#34;proc_36&amp;#34;$sep&amp;#34;proc_37&amp;#34;$sep&amp;#34;proc_38&amp;#34;$sep&amp;#34;proc_39&amp;#34;$sep&amp;#34;proc_40&amp;#34;$sep&amp;#34;proc_41&amp;#34;$sep&amp;#34;proc_42&amp;#34;$sep&amp;#34;proc_42&amp;#34;$sep&amp;#34;proc_43&amp;#34;$sep&amp;#34;proc_44&amp;#34;$sep&amp;#34;proc_45&amp;#34;$sep&amp;#34;proc_46&amp;#34;$sep&amp;#34;proc_47&amp;#34;$sep&amp;#34;proc_48&amp;#34; echo $head echo $head &amp;gt; loadavg_output.csv for (( ; ; )); do	#LOOP INFINITO #variables timestamp=`date &#43;%Y-%m-%d_%H-%M-%S` load=`cat /proc/loadavg | awk &amp;#39;{print $1}&amp;#39;` quote=`df -h / | awk &amp;#39;{print $5}&amp;#39;| tail -n 1` #uso del directorio raiz free_mem=`free -g | awk &amp;#39;{print $3}&amp;#39; | sed -n 2p` #Procesadores (48) proc_01=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $2}&amp;#39;` proc_02=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $4}&amp;#39;` proc_03=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $6}&amp;#39;` proc_04=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $8}&amp;#39;` proc_05=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $10}&amp;#39;` proc_06=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $12}&amp;#39;` proc_07=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $14}&amp;#39;` proc_09=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $16}&amp;#39;` proc_10=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $18}&amp;#39;` proc_11=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $20}&amp;#39;` proc_12=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $22}&amp;#39;` proc_13=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $24}&amp;#39;` proc_14=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $26}&amp;#39;` proc_15=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $28}&amp;#39;` proc_16=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $30}&amp;#39;` proc_17=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $32}&amp;#39;` proc_18=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $34}&amp;#39;` proc_19=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $36}&amp;#39;` proc_20=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $38}&amp;#39;` proc_21=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $40}&amp;#39;` proc_22=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $42}&amp;#39;` proc_23=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $44}&amp;#39;` proc_24=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $46}&amp;#39;` proc_25=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $48}&amp;#39;` proc_26=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $50}&amp;#39;` proc_27=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $52}&amp;#39;` proc_28=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $54}&amp;#39;` proc_29=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $56}&amp;#39;` proc_30=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $58}&amp;#39;` proc_31=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $60}&amp;#39;` proc_32=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $62}&amp;#39;` proc_33=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $64}&amp;#39;` proc_34=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $66}&amp;#39;` proc_35=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $68}&amp;#39;` proc_36=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $70}&amp;#39;` proc_37=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $72}&amp;#39;` proc_38=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $74}&amp;#39;` proc_39=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $76}&amp;#39;` proc_40=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $78}&amp;#39;` proc_41=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $80}&amp;#39;` proc_42=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $82}&amp;#39;` proc_43=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $84}&amp;#39;` proc_44=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $86}&amp;#39;` proc_45=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $88}&amp;#39;` proc_46=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $90}&amp;#39;` proc_47=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $92}&amp;#39;` proc_48=`top | head -n 3 | sed -n 3p | awk &amp;#39;{print $94}&amp;#39;` sleep 30 &amp;amp;	#guardo toda la info dentro de una variable var=$(echo $timestamp$sep$load$sep$quote$sep$free_mem$sep$proc_01$sep$proc_02$sep$proc_03$sep$proc_04$sep$proc_05$sep$proc_06$sep$proc_07$sep$proc_08sep$proc_09$sep$proc_10$sep$proc_11$sep$proc_12$sep$proc_13$sep$proc_14$sep$proc_15$sep$proc_16$sep$proc_17$sep$proc_18$sep$proc_19$sep$proc_20$sep$proc_21$sep$proc_22$sep$proc_23$sep$proc_24$sep$proc_25$sep$proc_26$sep$proc_27$sep$proc_28$sep$proc_29$sep$proc_30$sep$proc_31$sep$proc_32$sep$proc_33$sep$proc_34$sep$proc_35$sep$proc_36$sep$proc_37$sep$proc_38$sep$proc_39$sep$proc_40$sep$proc_41$sep$proc_42$sep$proc_43$sep$proc_44$sep$proc_45$sep$proc_46$sep$proc_47$sep$proc_48) echo $var echo $var &amp;gt;&amp;gt; loadavg_output."/>
<meta property="og:description" content="Book, Purchase, Sign up, Author, Download, PDF, Capitalism, Hacking, Tech Industry, Silicon Valley, San Francisco, Bay Area, Exploit, Career, Guide, Humans, Computers, Money, books, booktok, bookish, bookworm, bookrecs, fyp, book, foryou, bookstan"/>
<meta property="og:title" content="Script Monitoreo de Recursos" />


<title>

Hacking

</title>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-2N5YYN3BX6"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-2N5YYN3BX6');
</script>
</head><body><header class="header glow">
  <span class="header-inner">
    <span class="logo glow" title="001">
    <a href="/" class="logo" style="text-decoration: none">
    <span class="color-highlight">[</span>
    <span class="color-alt">lwn</span>
    <span class="color-highlight">@</span>
    <span class="color-highlight">001</span>
    <span class="color-alt">]: </span>
    </a>
    
    <span class="color-highlight">  ~/monitoreoRecursos</span>
    
    <span class="color-alt">$</span>
  <span class="logo-cursor"></span>
</span>
    <span class="header-right">
      
        <nav class="menu content-desktop">
    <ul class="menu-inner menu-inner--desktop">
        <li>./</li>
        
        <li><a href="../">../</a></li>
        
    </ul>
</nav>

      

      
      

      
      

      
      
      <a href="https://github.com/ktmtrk" title="ktmtrk" target="_blank" rel="noopener noreferrer" class="menu-icon">
        
<span class="content-fa"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span>

      </a>
      

      
      
      <a href="https://discord.com/users/lwn#1946" title="Send DM" target="_blank" rel="noopener noreferrer" class="menu-icon">
        
<span class="content-fa"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path fill="currentColor" d="M524.531,69.836a1.5,1.5,0,0,0-.764-.7A485.065,485.065,0,0,0,404.081,32.03a1.816,1.816,0,0,0-1.923.91,337.461,337.461,0,0,0-14.9,30.6,447.848,447.848,0,0,0-134.426,0,309.541,309.541,0,0,0-15.135-30.6,1.89,1.89,0,0,0-1.924-.91A483.689,483.689,0,0,0,116.085,69.137a1.712,1.712,0,0,0-.788.676C39.068,183.651,18.186,294.69,28.43,404.354a2.016,2.016,0,0,0,.765,1.375A487.666,487.666,0,0,0,176.02,479.918a1.9,1.9,0,0,0,2.063-.676A348.2,348.2,0,0,0,208.12,430.4a1.86,1.86,0,0,0-1.019-2.588,321.173,321.173,0,0,1-45.868-21.853,1.885,1.885,0,0,1-.185-3.126c3.082-2.309,6.166-4.711,9.109-7.137a1.819,1.819,0,0,1,1.9-.256c96.229,43.917,200.41,43.917,295.5,0a1.812,1.812,0,0,1,1.924.233c2.944,2.426,6.027,4.851,9.132,7.16a1.884,1.884,0,0,1-.162,3.126,301.407,301.407,0,0,1-45.89,21.83,1.875,1.875,0,0,0-1,2.611,391.055,391.055,0,0,0,30.014,48.815,1.864,1.864,0,0,0,2.063.7A486.048,486.048,0,0,0,610.7,405.729a1.882,1.882,0,0,0,.765-1.352C623.729,277.594,590.933,167.465,524.531,69.836ZM222.491,337.58c-28.972,0-52.844-26.587-52.844-59.239S193.056,219.1,222.491,219.1c29.665,0,53.306,26.82,52.843,59.239C275.334,310.993,251.924,337.58,222.491,337.58Zm195.38,0c-28.971,0-52.843-26.587-52.843-59.239S388.437,219.1,417.871,219.1c29.667,0,53.307,26.82,52.844,59.239C470.715,310.993,447.538,337.58,417.871,337.58Z"/></svg>
</span>

      </a>
      

      
      



    </span>
  </span>
</header>
<div id="content">

  

    <div class="flex-row">
    <div class="content">

      <div class="content-container">


    <h1 class="content-h1">Script Monitoreo de Recursos</h1>
    <div class="content-meta">
          <div class="content-more">
          
          </div>
    </div>

    
      <span class="content-meta">
        
          <a href="https://ktmtrk.github.io/tags/bash/">#bash</a>&nbsp;
        
          <a href="https://ktmtrk.github.io/tags/linux/">#linux</a>&nbsp;
        
          <a href="https://ktmtrk.github.io/tags/top/">#top</a>&nbsp;
        
          <a href="https://ktmtrk.github.io/tags/processors/">#processors</a>&nbsp;
        
          <a href="https://ktmtrk.github.io/tags/awk/">#awk</a>&nbsp;
        
          <a href="https://ktmtrk.github.io/tags/csv/">#csv</a>&nbsp;
        
          <a href="https://ktmtrk.github.io/tags/monitoring/">#monitoring</a>&nbsp;
        
      </span>
    


    <div class="post-content">
      
      <p>Script realizado para obtener algunos valores del top (linux)
filtrado de columnas, el script se ejecuta cada 30&rsquo; para imprimirlos por pantalla y a la vez grabar cada registro en un archivo csv
En este caso se adapto para sacar la carga de 48 nucleos de un servidor.</p>
<p><strong>load_avg.sh</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sep<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;|&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#title</span>
</span></span><span style="display:flex;"><span>head<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;timestamp&#34;</span>$sep<span style="color:#e6db74">&#34;load_avg&#34;</span>$sep<span style="color:#e6db74">&#34;%-/&#34;</span>$sep<span style="color:#e6db74">&#34;free_mem&#34;</span>$sep<span style="color:#e6db74">&#34;proc01&#34;</span>$sep<span style="color:#e6db74">&#34;proc_02&#34;</span>$sep<span style="color:#e6db74">&#34;proc_03&#34;</span>$sep<span style="color:#e6db74">&#34;proc_04&#34;</span>$sep<span style="color:#e6db74">&#34;proc_05&#34;</span>$sep<span style="color:#e6db74">&#34;proc_06&#34;</span>$sep<span style="color:#e6db74">&#34;proc07&#34;</span>$sep<span style="color:#e6db74">&#34;proc_08&#34;</span>$sep<span style="color:#e6db74">&#34;proc_09&#34;</span>$sep<span style="color:#e6db74">&#34;proc_10&#34;</span>$sep<span style="color:#e6db74">&#34;proc_11&#34;</span>$sep<span style="color:#e6db74">&#34;proc_12&#34;</span>$sep<span style="color:#e6db74">&#34;proc_13&#34;</span>$sep<span style="color:#e6db74">&#34;proc_14&#34;</span>$sep<span style="color:#e6db74">&#34;proc_15&#34;</span>$sep<span style="color:#e6db74">&#34;proc_16&#34;</span>$sep<span style="color:#e6db74">&#34;proc_17&#34;</span>$sep<span style="color:#e6db74">&#34;proc_18&#34;</span>$sep<span style="color:#e6db74">&#34;proc_19&#34;</span>$sep<span style="color:#e6db74">&#34;proc_20&#34;</span>$sep<span style="color:#e6db74">&#34;proc_21&#34;</span>$sep<span style="color:#e6db74">&#34;proc_22&#34;</span>$sep<span style="color:#e6db74">&#34;proc_23&#34;</span>$sep<span style="color:#e6db74">&#34;proc_24&#34;</span>$sep<span style="color:#e6db74">&#34;proc_25&#34;</span>$sep<span style="color:#e6db74">&#34;proc_26&#34;</span>$sep<span style="color:#e6db74">&#34;proc_27&#34;</span>$sep<span style="color:#e6db74">&#34;proc_28&#34;</span>$sep<span style="color:#e6db74">&#34;proc_29&#34;</span>$sep<span style="color:#e6db74">&#34;proc_30&#34;</span>$sep<span style="color:#e6db74">&#34;proc_31&#34;</span>$sep<span style="color:#e6db74">&#34;proc_32&#34;</span>$sep<span style="color:#e6db74">&#34;proc_33&#34;</span>$sep<span style="color:#e6db74">&#34;proc_34&#34;</span>$sep<span style="color:#e6db74">&#34;proc_35&#34;</span>$sep<span style="color:#e6db74">&#34;proc_36&#34;</span>$sep<span style="color:#e6db74">&#34;proc_37&#34;</span>$sep<span style="color:#e6db74">&#34;proc_38&#34;</span>$sep<span style="color:#e6db74">&#34;proc_39&#34;</span>$sep<span style="color:#e6db74">&#34;proc_40&#34;</span>$sep<span style="color:#e6db74">&#34;proc_41&#34;</span>$sep<span style="color:#e6db74">&#34;proc_42&#34;</span>$sep<span style="color:#e6db74">&#34;proc_42&#34;</span>$sep<span style="color:#e6db74">&#34;proc_43&#34;</span>$sep<span style="color:#e6db74">&#34;proc_44&#34;</span>$sep<span style="color:#e6db74">&#34;proc_45&#34;</span>$sep<span style="color:#e6db74">&#34;proc_46&#34;</span>$sep<span style="color:#e6db74">&#34;proc_47&#34;</span>$sep<span style="color:#e6db74">&#34;proc_48&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo $head
</span></span><span style="display:flex;"><span>echo $head &gt; loadavg_output.csv
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> <span style="color:#f92672">((</span> ; ; <span style="color:#f92672">))</span>; <span style="color:#66d9ef">do</span>	   <span style="color:#75715e">#LOOP INFINITO</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#75715e">#variables</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   timestamp<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>date +%Y-%m-%d_%H-%M-%S<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   load<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>cat /proc/loadavg | awk <span style="color:#e6db74">&#39;{print $1}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   quote<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>df -h / | awk <span style="color:#e6db74">&#39;{print $5}&#39;</span>| tail -n 1<span style="color:#e6db74">`</span> <span style="color:#75715e">#uso del directorio raiz</span>
</span></span><span style="display:flex;"><span>   free_mem<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>free -g | awk <span style="color:#e6db74">&#39;{print $3}&#39;</span> | sed -n 2p<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>   <span style="color:#75715e">#Procesadores (48)</span>
</span></span><span style="display:flex;"><span>   proc_01<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $2}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_02<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $4}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_03<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $6}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_04<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $8}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_05<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $10}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_06<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $12}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_07<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $14}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_09<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $16}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_10<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $18}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_11<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $20}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_12<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $22}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_13<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $24}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_14<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $26}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_15<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $28}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_16<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $30}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_17<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $32}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_18<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $34}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_19<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $36}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_20<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $38}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_21<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $40}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_22<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $42}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_23<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $44}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_24<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $46}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_25<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $48}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_26<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $50}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_27<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $52}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_28<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $54}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_29<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $56}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_30<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $58}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_31<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $60}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_32<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $62}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_33<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $64}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_34<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $66}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_35<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $68}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_36<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $70}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_37<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $72}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_38<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $74}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_39<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $76}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_40<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $78}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_41<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $80}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_42<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $82}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_43<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $84}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_44<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $86}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_45<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $88}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_46<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $90}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_47<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $92}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   proc_48<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>top | head -n <span style="color:#ae81ff">3</span> | sed -n 3p  | awk <span style="color:#e6db74">&#39;{print $94}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>   sleep <span style="color:#ae81ff">30</span> &amp;	           
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>   <span style="color:#75715e">#guardo toda la info dentro de una variable</span>
</span></span><span style="display:flex;"><span>   var<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>echo $timestamp$sep$load$sep$quote$sep$free_mem$sep$proc_01$sep$proc_02$sep$proc_03$sep$proc_04$sep$proc_05$sep$proc_06$sep$proc_07$sep$proc_08sep$proc_09$sep$proc_10$sep$proc_11$sep$proc_12$sep$proc_13$sep$proc_14$sep$proc_15$sep$proc_16$sep$proc_17$sep$proc_18$sep$proc_19$sep$proc_20$sep$proc_21$sep$proc_22$sep$proc_23$sep$proc_24$sep$proc_25$sep$proc_26$sep$proc_27$sep$proc_28$sep$proc_29$sep$proc_30$sep$proc_31$sep$proc_32$sep$proc_33$sep$proc_34$sep$proc_35$sep$proc_36$sep$proc_37$sep$proc_38$sep$proc_39$sep$proc_40$sep$proc_41$sep$proc_42$sep$proc_43$sep$proc_44$sep$proc_45$sep$proc_46$sep$proc_47$sep$proc_48<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   echo $var
</span></span><span style="display:flex;"><span>   echo $var &gt;&gt; loadavg_output.csv 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   wait
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Show top five CPU consuming processes with top</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#top -b -n 1 | head -n 12  | tail -n 5</span>
</span></span></code></pre></div><p><strong>example output:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>       │ File: loadavg_output.csv
</span></span><span style="display:flex;"><span>  ─────┼──────────────────────────────────────────────────────────────────────────────
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">1</span>   │ timestamp|load_avg|% - /|free_mem|proc01|proc_02|proc_03|proc_04|proc_05|proc_06|proc07|proc_08
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">2</span>   │ 2021-09-01_17-13-21|0.16|19%|3354940|3,5|0,7|0,0|98,4|98,4|0,0|0,0|0,0|0,0
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">3</span>   │ 2021-09-01_17-13-58|0.09|19%|3357212|0,0|1,5|0,0|96,2|96,2|0,0|0,0|0,0|0,0
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">4</span>   │ 2021-09-01_17-14-30|0.05|19%|3343052|0,8|0,0|0,0|99,2|99,2|0,0|0,0|0,0|0,0
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">5</span>   │ 2021-09-01_17-15-10|0.02|19%|3345536|0,0|0,8|0,0|98,5|98,5|0,0|0,0|0,0|0,0
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">6</span>   │ 2021-09-01_17-15-45|0.13|19%|3378360|0,8|1,4|0,0|96,5|96,5|0,0|0,0|0,0|0,0
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">7</span>   │ 2021-09-01_17-16-19|0.22|19%|3373244|4,5|3,0|0,0|93,1|93,1|0,0|0,0|0,0|0,0
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">8</span>   │ 2021-09-01_17-16-51|0.27|19%|3380212|0,7|1,5|0,0|98,6|98,6|0,0|0,0|0,0|0,0
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">9</span>   │ 2021-09-01_17-17-25|0.16|19%|3379788|0,7|2,3|0,0|97,9|97,9|0,0|0,0|0,0|0,0
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">10</span>   │ 2021-09-01_17-18-00|0.09|19%|3359756|0,0|0,8|0,0|97,7|97,7|0,0|0,0|0,0|0,0
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">11</span>   │ 2021-09-01_17-18-31|0.05|19%|3356716|0,0|3,5|0,0|97,8|97,8|0,0|0,0|0,0|0,0
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">12</span>   │ 2021-09-01_17-19-02|0.32|19%|3368736|0,7|0,8|0,0|95,7|95,7|0,0|0,0|0,0|0,0
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">13</span>   │ 2021-09-01_17-19-34|0.19|19%|3371864|2,2|1,5|0,0|97,1|97,1|0,0|0,0|0,0|0,0
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">14</span>   │ 2021-09-01_17-20-08|0.18|19%|3373824|0,7|0,7|0,0|98,5|98,5|0,7|0,0|0,0|0,0
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">15</span>   │ 2021-09-01_17-20-40|0.11|19%|3371536|3,0|2,1|0,0|94,1|94,1|0,0|0,0|0,0|0,0
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">16</span>   │ 2021-09-01_17-21-11|0.06|19%|3377288|2,7|1,4|0,0|85,8|85,8|0,0|0,0|0,0|0,0
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">17</span>   │ 2021-09-01_17-21-43|0.30|19%|3356732|7,1|2,2|0,0|98,5|98,5|0,0|0,0|0,0|0,0
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">18</span>   │ 2021-09-01_17-22-14|0.18|19%|3360304|0,7|0,7|0,0|95,5|95,5|0,0|0,0|0,0|0,0
</span></span><span style="display:flex;"><span>───────┴──────────────────────────────────────────────────────────────────────────────
</span></span></code></pre></div><p>+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
|    <strong>KTMTRK</strong>      |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+</p>

    </div>
    

    
      
    
      </div>
  </div>
  </div>

        </div>
    </body><footer class="footer">
  <div class="content-p" style="text-align: center">
      <div style="padding-bottom: 10px">Copyright <a href="">2023 Lio Nievas</a></div>
  </div>
</footer></html>
